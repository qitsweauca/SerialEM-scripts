ScriptName LD
# main macro for single particle data collection in Low Dose Mode
# update @ 2018-05-27  
# 
# after R shot

# define buffer to which ref image is copied temporarily
buffer = T

Echo ===> Running LD ...

buffer = T              # reference buffer for positioning

## position (X,Y)
RealignToNavItem 0      # stays in LD-View after realign
ResetImageShift
Copy A $buffer          # comment out this line if you have a template hole in ref buffer 
CallFunction MyFuncs::Relax   # move stage backward for 25nm 
CallFunction MyFuncs::BufferShot $buffer  # take shot mimicing image in ref buffer
AlignTo $buffer         # some IS is left here, it is OK, specially "AdjustBeamTiltForIS" is on

## Center Beam, assume AutoCenterBeam policy has been set up
AutoCenterBeam

## autofocus
CallFunction MyFuncs::CycleTargetFocus -1.2 -2.2 0.1 
G

## Drift control, till 2A/sec, using F shot
CallFunction MyFuncs::Drift 2 F

GotoLowDoseArea R
AdjustBeamTiltForIS     # this compensates small beam tilt being off due to small IS

MultipleRecords         # for multi-shot
#EarlyReturnNextShot 0  # single-shot
#R

ReportClock
echo ----------------------------------------------------------------
